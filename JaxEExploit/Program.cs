#region

using LeagueSharp;
using LeagueSharp.Common;

#endregion

namespace JaxEExploit
{
    internal class Program
    {
        public static Spell E;
        public static Obj_AI_Base Target;
        public static Menu Menu;

        private static void Main(string[] args)
        {
            Menu = new Menu("Jax E Exploit", "Jax E Exploit", true);
            Menu.AddItem(new MenuItem("Key", "Key").SetValue(new KeyBind(32, KeyBindType.Press)));
            Menu.AddToMainMenu();

            E = new Spell(SpellSlot.E);
            Game.OnGameSendPacket += Game_OnGameSendPacket;
            Game.OnGameUpdate += Game_OnGameUpdate;
        }

        private static void Game_OnGameUpdate(System.EventArgs args)
        {
            if (Menu.Item("Key").GetValue<KeyBind>().Active && Target != null && !Target.IsDead && E.IsReady())
            {
                E.CastOnUnit(Target, true);
            }
        }

        private static void Game_OnGameSendPacket(GamePacketEventArgs args)
        {
            if (args.PacketData[0] != Packet.C2S.SetTarget.Header)
            {
                return;
            }

            var decoded = Packet.C2S.SetTarget.Decoded(args.PacketData);

            if (!decoded.Unit.IsMe)
            {
                Target = decoded.Unit;
            }
        }
    }
}